(function(){"use strict";var e={7378:function(e,t,a){var s=a(9963),o=a(6252);function n(e,t,a,s,n,A){const i=(0,o.up)("router-view");return(0,o.wg)(),(0,o.j4)(i)}a(7658);var A={name:"App",created(){this.$router.push({name:"start"})}},i=a(3744);const r=(0,i.Z)(A,[["render",n]]);var l=r,d=a(5205);(0,d.z)("/intomyc/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(e){console.error("Error during service worker registration:",e)}});var u=a(2201);const c={class:"container"};function g(e,t,a,s,n,A){const i=(0,o.up)("router-view");return(0,o.wg)(),(0,o.iD)("div",c,[(0,o.Wm)(i)])}var p={name:"StartView",created(){this.$router.push({name:"entry"})}};const m=(0,i.Z)(p,[["render",g],["__scopeId","data-v-30b129ad"]]);var h=m,f=a(3577),v="data:image/png;base64,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pr/pb/qb/qa/6W/6m/42U1utv/7666+//vrrr7/++uuvv/7666+//vrrr7/++uuvv/7666+//vrrr7/++uuvv/7666+//vrrr7/++uuvv/7662+vZv8J/fXXX3/99ddff/31119//fXXX3/99ddff/2buDX666+//vrrr7/++uuvv/7666+//vrrr7/++uuvv/7666+//vrrr7/++uuvv/7666+//vrrr7/++uuvv/7666+//qa/6W/6m/6mv+lv+pv+pr/pb/rbjG2t/vrrr7/++uuvv/7666+//vrrr7/++uuvv/7666+//vrrr7/++uuvv/7666+//rOz/z399ddff/31119//fXXX3/99ddff/31119//fXXX3/99ddff/31119//fXXX3/9Z+PW6a+//vrrr7/++uuvv/7666+//vrrr7/++uuvv/7666+//vrrr7/++uuvv/7666+//vrrr7/++uuvv/7666+//vqb/qa/6W/6m/6mv+lv+pv+pr/N6Lr1119//fXXX/+4ef5n9pbc0T9586/qH73T+kfvoP7R63uif/IW39c/esf1j17XlP5+AtA/dque6h+9i/pHr1v/7B3TP3u39I/eCv2z96X+2WvpH723pvSP3hb9s7dH/+wd1j97Q/pn70f9szesf/bG9M/ebf2zd03/7F3SP3sn9M9ev/7Z269/9rbrn71l+odvVP/sDeifvV79s9cxrn/2TumfvR36h78G3NA/e9v0z97cEf2zt0n/8LX0z16P/uHr1z/8+8Dz+mdvwaj+2Vt+V//sbXisf/b2ti1gss/VGvV+0ER7/cdWulmz1tXWr4Vai1ysaVvYxlNjhzrdq3mbd2Sa+R/tc6xmbv20Hhhwwct/c7f1+ktf/XtcqdGvAztf+PjgkY1O1PR17j43+fz64ye995OxNzZ/+9ez9UcHejtcJmgffPrV4Nkrfzy4f7N15uiBXUtdZCb2HyDq9i+SDCuqAAAAAElFTkSuQmCC";const w=e=>((0,o.dD)("data-v-d31c13e4"),e=e(),(0,o.Cn)(),e),D={class:"main"},I=w((()=>(0,o._)("img",{src:v,alt:""},null,-1))),b=[I],y={class:"nick"},E=["src"],B={class:"menu"};function k(e,t,a,s,n,A){const i=(0,o.up)("router-view"),r=(0,o.up)("download-display");return(0,o.wg)(),(0,o.iD)("div",D,[(0,o._)("div",{class:(0,f.C_)(["aside",{close:n.asideShow}])},[(0,o._)("button",{class:(0,f.C_)(["btn-aside",{rotate:!n.asideShow}]),onClick:t[0]||(t[0]=e=>n.asideShow=0==n.asideShow)},b,2),(0,o._)("div",null,[(0,o._)("p",y,(0,f.zw)(e.name),1),(0,o._)("img",{src:e.photo?.src,alt:"",class:"photo"},null,8,E)]),(0,o._)("ul",B,[(0,o._)("li",{class:"menu__item",onClick:t[1]||(t[1]=e=>A.toSearch())},"Search people"),(0,o._)("li",{class:"menu__item",onClick:t[2]||(t[2]=e=>A.toMess())},"Messages"),(0,o._)("li",{class:"menu__item",onClick:t[3]||(t[3]=e=>A.toSett())},"Settings"),(0,o._)("li",{class:"menu__item",onClick:t[4]||(t[4]=e=>A.exit())},"Exit")])],2),(0,o.Wm)(i,{class:"content-view"}),(0,o.Wm)(r,{work:e.download},null,8,["work"])])}const Q=e=>((0,o.dD)("data-v-1259ffaf"),e=e(),(0,o.Cn)(),e),C={key:0,class:"wrapper"},_=Q((()=>(0,o._)("div",{class:"dots"},[(0,o._)("div",{class:"dot d1"}),(0,o._)("div",{class:"dot d2"}),(0,o._)("div",{class:"dot d3"})],-1))),S=[_];function U(e,t,a,s,n,A){return a.work?((0,o.wg)(),(0,o.iD)("div",C,S)):(0,o.kq)("",!0)}var V={name:"DownloadDisplay",props:{text:{type:String,default:"",required:!1},work:{type:Boolean,default:!1,required:!0}}};const x=(0,i.Z)(V,[["render",U],["__scopeId","data-v-1259ffaf"]]);var P=x,W=a(3907),T={name:"UserView",components:{DownloadDisplay:P},created(){this.toMess()},data(){return{asideShow:!0}},methods:{...(0,W.nv)(["downloadPersonalKey","unlogin"]),toMess(){this.$router.push({name:"mess"}),this.asideShow=!0},toSett(){this.$router.push({name:"sett"}),this.asideShow=!0},toSearch(){this.asideShow=!0,this.$router.push({name:"search"})},exit(){this.unlogin((()=>{this.asideShow=!0,this.$router.push({name:"start"})}))}},computed:{...(0,W.Se)(["name","photo","uid","download"])}};const $=(0,i.Z)(T,[["render",k],["__scopeId","data-v-d31c13e4"]]);var q=$;const N=e=>((0,o.dD)("data-v-651590b6"),e=e(),(0,o.Cn)(),e),O={class:"window"},L=N((()=>(0,o._)("h1",{class:"title"},"Intomyc",-1))),z={class:"save"},M={type:"checkbox",ref:"check"},H=N((()=>(0,o._)("div",{class:"text"},"Remember me",-1)));function X(e,t,a,s,n,A){const i=(0,o.up)("default-field"),r=(0,o.up)("default-button"),l=(0,o.up)("default-link"),d=(0,o.up)("download-display");return(0,o.wg)(),(0,o.iD)("div",O,[L,(0,o.Wm)(i,{fieldType:"text",text:"Your email",fieldValue:n.email,"onUpdate:fieldValue":t[0]||(t[0]=e=>n.email=e),class:"field-out"},null,8,["fieldValue"]),(0,o.Wm)(i,{fieldType:"password",text:"Your password",fieldValue:n.password,"onUpdate:fieldValue":t[1]||(t[1]=e=>n.password=e),class:"field-out"},null,8,["fieldValue"]),(0,o._)("div",z,[(0,o._)("input",M,null,512),H]),(0,o.Wm)(r,{text:"Sign in",onClickIn:t[2]||(t[2]=e=>A.login()),class:"btn-out"}),(0,o.Wm)(l,{text:"Create account",onClickIn:t[3]||(t[3]=e=>A.toCreate()),class:"link-out"}),(0,o.Wm)(d,{work:e.download},null,8,["work"])])}const Z={class:"container"},j={class:"text"},R=["type","value"];function F(e,t,a,s,n,A){return(0,o.wg)(),(0,o.iD)("div",Z,[(0,o._)("p",j,(0,f.zw)(a.text),1),(0,o._)("input",{class:"field",type:a.fieldType,value:a.fieldValue,onInput:t[0]||(t[0]=t=>e.$emit("update:fieldValue",t.target.value))},null,40,R)])}var Y={name:"DefaultField.vue",props:{fieldValue:{type:String,default:"",required:!0},text:{type:String,default:"text for field",required:!0},fieldType:{type:String,default:"text",required:!0}}};const K=(0,i.Z)(Y,[["render",F],["__scopeId","data-v-2c2587af"]]);var G=K;function J(e,t,a,s,n,A){return(0,o.wg)(),(0,o.iD)("button",{class:"btn-in",onClick:t[0]||(t[0]=t=>e.$emit("clickIn"))},(0,f.zw)(a.text),1)}var ee={name:"DefaultButton",props:{text:{type:String,default:"button",required:!1}},emits:{clickIn:null}};const te=(0,i.Z)(ee,[["render",J],["__scopeId","data-v-b15c8904"]]);var ae=te;function se(e,t,a,s,n,A){return(0,o.wg)(),(0,o.iD)("a",{class:"link-in",onClick:t[0]||(t[0]=t=>e.$emit("clickIn"))},(0,f.zw)(a.text),1)}var oe={name:"DefaultLink",props:{text:{type:String,default:"link",required:!0}},emits:{clickIn:null}};const ne=(0,i.Z)(oe,[["render",se],["__scopeId","data-v-8e201f94"]]);var Ae=ne,ie={name:"EntryPage",components:{DefaultField:G,DefaultButton:ae,DefaultLink:Ae,DownloadDisplay:P},data(){return{email:"",password:""}},created(){const e=localStorage.getItem("AUTOENTRYKEY"),t=localStorage.getItem("checkbox");e&&t&&(this.work=!0,this.autoEntry({key:e,cb:()=>{this.$router.push({name:"user"})}}))},methods:{...(0,W.nv)(["auth","autoEntry"]),login(){""!=this.email&&this.password.length>=6&&(this.work=!0,this.auth({email:this.email,password:this.password,cb:()=>{this.$router.push({name:"user"}),localStorage.setItem("checkbox",!!this.$refs.check.checked||"")}}))},toCreate(){this.$router.push({name:"reg"})}},computed:{...(0,W.Se)(["download"])}};const re=(0,i.Z)(ie,[["render",X],["__scopeId","data-v-651590b6"]]);var le=re;const de={class:"window"};function ue(e,t,a,s,n,A){const i=(0,o.up)("default-field"),r=(0,o.up)("default-button"),l=(0,o.up)("default-link");return(0,o.wg)(),(0,o.iD)("div",de,[(0,o.Wm)(i,{fieldType:"text",text:"Write email",fieldValue:n.email,"onUpdate:fieldValue":t[0]||(t[0]=e=>n.email=e),class:"field-out"},null,8,["fieldValue"]),(0,o.Wm)(i,{fieldType:"text",text:"Write name",fieldValue:n.name,"onUpdate:fieldValue":t[1]||(t[1]=e=>n.name=e),class:"field-out"},null,8,["fieldValue"]),(0,o.Wm)(i,{fieldType:"password",text:"Write password",fieldValue:n.password,"onUpdate:fieldValue":t[2]||(t[2]=e=>n.password=e),class:"field-out"},null,8,["fieldValue"]),(0,o.Wm)(i,{fieldType:"password",text:"Repeat password",fieldValue:n.password2,"onUpdate:fieldValue":t[3]||(t[3]=e=>n.password2=e),class:"field-out"},null,8,["fieldValue"]),(0,o.Wm)(r,{text:"Create one",onClickIn:t[4]||(t[4]=e=>A.create()),class:"btn-out"}),(0,o.Wm)(l,{text:"Back to entry",onClickIn:t[5]||(t[5]=e=>A.toLogin()),class:"link-out"})])}var ce={name:"RegPage",components:{DefaultField:G,DefaultButton:ae,DefaultLink:Ae},data(){return{name:"",email:"",password:"",password2:""}},methods:{...(0,W.nv)(["loginNewUser"]),create(){this.password==this.password2&&this.password.length>=6&&(this.loginNewUser({email:this.email,password:this.password,name:this.name}),this.$router.push({name:"entry"}))},toLogin(){this.$router.push({name:"entry"})}}};const ge=(0,i.Z)(ce,[["render",ue],["__scopeId","data-v-5d41eb07"]]);var pe=ge;const me={class:"container scroll"},he={key:0,class:"no-dialogs"};function fe(e,t,a,s,n,A){const i=(0,o.up)("dialog-item");return(0,o.wg)(),(0,o.iD)("div",me,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.dialogs,(t=>((0,o.wg)(),(0,o.j4)(i,{key:t.id,photoSrc:t.companionData.photo.src,nameFrom:t.companionData.name,whoLast:t.messages[t.messages.length-1].from,unWatched:t.messages.filter((t=>0==t.watched&&t.from!=e.uid)).length,lastMess:t.messages[t.messages.length-1].text,onClick:e=>A.toDialog(t.id)},null,8,["photoSrc","nameFrom","whoLast","unWatched","lastMess","onClick"])))),128)),0==e.dialogs.length?((0,o.wg)(),(0,o.iD)("div",he,"No dialogues yet")):(0,o.kq)("",!0)])}const ve=e=>((0,o.dD)("data-v-0c7be56c"),e=e(),(0,o.Cn)(),e),we=["src"],De={class:"name"},Ie={key:0,class:"you"},be=ve((()=>(0,o._)("div",{class:"dots"},":",-1))),ye={class:"mess"},Ee={key:1,class:"count"};function Be(e,t,a,s,n,A){return(0,o.wg)(),(0,o.iD)("div",{class:(0,f.C_)(["wrapper",{unwatched:a.unWatched>0}])},[(0,o._)("img",{src:a.photoSrc,alt:"",class:"photo"},null,8,we),(0,o._)("div",De,(0,f.zw)(a.nameFrom),1),A.userLast?((0,o.wg)(),(0,o.iD)("div",Ie,"| You")):(0,o.kq)("",!0),be,(0,o._)("div",ye,(0,f.zw)(a.lastMess),1),a.unWatched?((0,o.wg)(),(0,o.iD)("div",Ee,(0,f.zw)(a.unWatched),1)):(0,o.kq)("",!0)],2)}var ke={name:"DialogItem",props:{nameFrom:{type:String,default:"User",required:!0},unWatched:{type:Number,default:0,required:!0},whoLast:{type:String,default:"User",required:!0},lastMess:{type:String,default:"",required:!0},photoSrc:{type:String,default:"",required:!0}},computed:{...(0,W.Se)(["uid"]),userLast(){return this.whoLast==this.uid}}};const Qe=(0,i.Z)(ke,[["render",Be],["__scopeId","data-v-0c7be56c"]]);var Ce=Qe,_e={name:"MessPage",components:{DialogItem:Ce},methods:{toDialog(e){this.$router.push({name:"dialog",params:{id:e}})}},computed:{...(0,W.Se)(["dialogs","name","uid"])}};const Se=(0,i.Z)(_e,[["render",fe],["__scopeId","data-v-2d2de094"]]);var Ue=Se;const Ve={class:"container"},xe={class:"list scroll"},Pe={class:"left"},We=["src"],Te={class:"name"},$e=["onClick"],qe={key:0,class:"no-users"};function Ne(e,t,a,n,A,i){const r=(0,o.up)("default-header");return(0,o.wg)(),(0,o.iD)("div",Ve,[(0,o.Wm)(r,{title:"Search people",class:"head"}),(0,o.wy)((0,o._)("input",{type:"text",class:"input","onUpdate:modelValue":t[0]||(t[0]=e=>A.searchValue=e)},null,512),[[s.nr,A.searchValue]]),(0,o._)("ul",xe,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(i.normalizedUsers,(e=>((0,o.wg)(),(0,o.iD)("li",{class:"list__item",key:e.uid},[(0,o._)("div",Pe,[(0,o._)("img",{src:e.photoObj.src,alt:"",class:"photo"},null,8,We),(0,o._)("div",Te,(0,f.zw)(e.name),1)]),(0,o._)("button",{class:"btn",onClick:t=>i.createDialog(e.uid)},"Write",8,$e)])))),128))]),0==i.normalizedUsers.length?((0,o.wg)(),(0,o.iD)("div",qe," Failed to find users ")):(0,o.kq)("",!0)])}const Oe={class:"wrapper"},Le=["src"],ze={class:"title"};function Me(e,t,a,s,n,A){return(0,o.wg)(),(0,o.iD)("header",Oe,[a.photoSrc?((0,o.wg)(),(0,o.iD)("img",{key:0,class:"photo",src:a.photoSrc,alt:""},null,8,Le)):(0,o.kq)("",!0),(0,o._)("h1",ze,(0,f.zw)(a.title),1)])}var He={name:"DefaultHeader",props:{title:{type:String,default:"Title",required:!0},photoSrc:{type:String,default:"",required:!1}}};const Xe=(0,i.Z)(He,[["render",Me],["__scopeId","data-v-3464fb21"]]);var Ze=Xe,je={name:"SearchPage",components:{DefaultHeader:Ze},created(){this.downloadUsersList()},data(){return{searchValue:""}},methods:{...(0,W.nv)(["downloadUsersList","createNewDialog"]),createDialog(e){this.createNewDialog({userUID:e,cb:e=>{this.$router.push({name:"dialog",params:{id:e}})}})}},computed:{...(0,W.Se)(["users"]),normalizedUsers(){return this.users.filter((e=>e.name.startsWith(this.searchValue)))}}};const Re=(0,i.Z)(je,[["render",Ne],["__scopeId","data-v-d45b6ff0"]]);var Fe=Re;const Ye=e=>((0,o.dD)("data-v-dfa3f82e"),e=e(),(0,o.Cn)(),e),Ke={class:"container"},Ge={class:"list"},Je={class:"list__item"},et=Ye((()=>(0,o._)("div",{class:"text"},"Change your photo:",-1))),tt={class:"list__item"},at=Ye((()=>(0,o._)("div",{class:"text"},"Change your name:",-1)));function st(e,t,a,n,A,i){const r=(0,o.up)("default-header"),l=(0,o.up)("default-button");return(0,o.wg)(),(0,o.iD)("div",Ke,[(0,o.Wm)(r,{title:"Settings",class:"head"}),(0,o._)("ul",Ge,[(0,o._)("li",Je,[et,(0,o.Wm)(l,{text:"Choose",onClickIn:t[0]||(t[0]=e=>i.selectPhoto())})]),(0,o._)("li",tt,[at,(0,o.wy)((0,o._)("input",{type:"text",class:"input","onUpdate:modelValue":t[1]||(t[1]=e=>A.nameValue=e),onChange:t[2]||(t[2]=e=>i.changeName())},null,544),[[s.nr,A.nameValue]])])]),(0,o._)("input",{type:"file",class:"input-file",ref:"inputFile",onChange:t[3]||(t[3]=e=>i.changePhoto())},null,544)])}var ot={name:"SettPage",components:{DefaultHeader:Ze,DefaultButton:ae},created(){this.nameValue=this.name},data(){return{nameValue:""}},computed:{...(0,W.Se)(["name"])},methods:{...(0,W.nv)(["changeUserName","uploadUserPhoto"]),changeName(){this.nameValue.length>=5?this.changeUserName(this.nameValue):this.nameValue=this.name},selectPhoto(){this.$refs.inputFile.click()},changePhoto(){this.uploadUserPhoto(this.$refs.inputFile.files[0])}}};const nt=(0,i.Z)(ot,[["render",st],["__scopeId","data-v-dfa3f82e"]]);var At=nt;const it={class:"container"},rt={class:"list scroll",ref:"list"};function lt(e,t,a,s,n,A){const i=(0,o.up)("default-header"),r=(0,o.up)("dialog-message"),l=(0,o.up)("message-input");return(0,o.wg)(),(0,o.iD)("div",it,[(0,o.Wm)(i,{title:e.dialogs.filter((e=>e.id==n.id))[0]?.companionData.name,photoSrc:e.dialogs.filter((e=>e.id==n.id))[0]?.companionData.photo.src},null,8,["title","photoSrc"]),(0,o._)("div",rt,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e.dialogs.filter((e=>e.id==n.id))[0]?.messages,((t,a)=>((0,o.wg)(),(0,o.j4)(r,{key:a,side:"start"==t.from?"start":t.from==e.uid?"right":"left",text:t.text,unwatched:!t.watched,class:"mess",style:(0,f.j5)({display:0==a?"none":"block"})},null,8,["side","text","unwatched","style"])))),128))],512),(0,o.Wm)(l,{onSend:t[0]||(t[0]=e=>A.send()),message:n.message,"onUpdate:message":t[1]||(t[1]=e=>n.message=e)},null,8,["message"])])}function dt(e,t,a,s,n,A){return(0,o.wg)(),(0,o.iD)("div",{class:(0,f.C_)(["message",{left:"left"==a.side,unwatched:a.unwatched,right:"right"==a.side}])},(0,f.zw)(a.text),3)}var ut={name:"DialogMessage",props:{text:{type:String,default:"text",required:!0},side:{type:String,default:"right",required:!0},unwatched:{type:Boolean,default:!1,required:!0}}};const ct=(0,i.Z)(ut,[["render",dt],["__scopeId","data-v-4b84c458"]]);var gt=ct;const pt={class:"wrapper"},mt=["value"];function ht(e,t,a,n,A,i){return(0,o.wg)(),(0,o.iD)("div",pt,[(0,o._)("input",{type:"text",class:"input",value:a.message,onInput:t[0]||(t[0]=t=>e.$emit("update:message",t.target.value)),onKeydown:t[1]||(t[1]=(0,s.D2)((t=>e.$emit("send")),["enter"]))},null,40,mt),(0,o._)("button",{class:"btn",onClick:t[2]||(t[2]=t=>e.$emit("send"))},"Send")])}var ft={name:"MessageInput",props:{message:{type:String,default:"",required:!1}},emits:{send:null,"update:message":null}};const vt=(0,i.Z)(ft,[["render",ht],["__scopeId","data-v-0502c121"]]);var wt=vt,Dt={name:"DialogPage",components:{DefaultHeader:Ze,DialogMessage:gt,MessageInput:wt},data(){return{id:"",message:""}},created(){this.id=this.$route.params.id,this.openDialog(this.id)},unmounted(){this.setCurrentDialog("")},computed:{...(0,W.Se)(["dialogs","name","uid"])},methods:{...(0,W.nv)(["sendMessage","openDialog"]),...(0,W.OI)(["setCurrentDialog"]),send(){this.sendMessage({text:this.message,id:this.id}),this.message=""}}};const It=(0,i.Z)(Dt,[["render",lt],["__scopeId","data-v-f6191e52"]]);var bt=It;const yt=[{path:"/",name:"app",component:l},{path:"/start",name:"start",component:h,children:[{path:"entry",name:"entry",component:le},{path:"registration",name:"reg",component:pe}]},{path:"/user",name:"user",component:q,children:[{path:"messages",name:"mess",component:Ue},{path:"settings",name:"sett",component:At},{path:"search",name:"search",component:Fe},{path:"dialog&id=:id",name:"dialog",component:bt}]}],Et=(0,u.p7)({history:(0,u.PO)("/intomyc/"),routes:yt});var Bt=Et,kt=a(4857),Qt=a(3977);const Ct={apiKey:"AIzaSyD1WCzE9LP5OZwBV8WnqgsopcChTQljROA",authDomain:"intomyc-2c473.firebaseapp.com",databaseURL:"https://intomyc-2c473-default-rtdb.firebaseio.com",projectId:"intomyc-2c473",storageBucket:"intomyc-2c473.appspot.com",messagingSenderId:"784806974289",appId:"1:784806974289:web:698d57380858abfb273970"},_t=(0,Qt.ZF)(Ct),St=(0,kt.v0)(_t);function Ut(e,t){return(0,kt.Xb)(St,e,t)}function Vt(e,t){return(0,kt.e5)(St,e,t)}var xt=a(9355);const Pt=(0,xt.N8)(_t);function Wt(e,t){const a=(0,xt.iH)(Pt,e);return(0,xt.t8)(a,t)}function Tt(e){const t=(0,xt.iH)(Pt,e);return(0,xt.U2)(t)}function $t(e,t){const a=(0,xt.iH)(Pt,e);return(0,xt.jM)(a,t)}var qt=a(6650);const Nt=(0,qt.cF)(_t);function Ot(e,t){const a=(0,qt.iH)(Nt,t);return(0,qt.sf)(a,e,"data_url")}function Lt(e){const t=(0,qt.iH)(Nt,e);return(0,qt.Jt)(t)}const zt=()=>{let e="";for(let t=0;t<10;t++)e+=`${Math.floor(10*Math.random())}`;return e},Mt=()=>{const e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890";let t="";for(let a=0;a<10;a++)t+=e[Math.floor(Math.random()*e.length)];return t};var Ht=(0,W.MT)({state:{uid:"",name:"",photo:"",dialogsID:[],dialogs:[],users:[],download:!1,currentDialog:""},actions:{loginNewUser({dispatch:e,commit:t},a){t("setDownload",!0),Ut(a.email,a.password).then((t=>{e("regNewUserInDatabase",{uid:t.user.uid,name:a.name,email:a.email,password:a.password})}))},regNewUserInDatabase({dispatch:e},t){Wt(`users/${t.uid}`,{name:t.name,dialogs:["dnone"],uid:t.uid,photo:!1}),e("regPersonalDataInDatabase",{uid:t.uid,email:t.email,password:t.password})},regPersonalDataInDatabase({dispatch:e,commit:t},a){e("empty");const s=Mt();Wt(`PERSONAL/${a.uid}`,{email:a.email,password:a.password,key:s}).then((()=>{Wt(`AUTOENTRYKEYS/${s}`,a.uid).then((()=>{t("setDownload",!1)}))}))},autoEntry({dispatch:e,commit:t},a){t("setDownload",!0),Tt(`AUTOENTRYKEYS/${a.key}`).then((t=>{const s=t.val();s&&Tt(`PERSONAL/${s}`).then((t=>{const s=t.val();s.key==a.key&&e("auth",{email:s.email,password:s.password,auto:!0,cb:a.cb})})).catch((e=>{console.log(e)}))})).catch((e=>{console.log(e)}))},unlogin({commit:e},t){localStorage.setItem("checkbox",""),e("clearData"),t()},downloadPersonalKey({dispatch:e},t){Tt(`PERSONAL/${t}/key`).then((t=>{localStorage.setItem("AUTOENTRYKEY",t.val()),e("empty")}))},empty(){},createNewDialog({state:e},t){Tt(`users/${t.userUID}`).then((a=>{const s=a.val(),o="d"+zt();s.dialogs?s.dialogs.push(o):s.dialogs=[o],Wt(`dialogs/${o}`,{uids:[t.userUID,e.uid],id:o,messages:[{from:"start",text:"",watched:!0}]}).then((()=>{Wt(`users/${e.uid}/dialogs`,e.dialogsID.length?[...e.dialogsID,o]:["dnone",o]).then((()=>{Wt(`users/${t.userUID}/dialogs`,s.dialogs).then((()=>{console.log("callback started"),t.cb(o)}))}))}))}))},auth({commit:e,dispatch:t},a){e("setDownload",!0),Vt(a.email,a.password).then((s=>{e("setUID",s.user.uid),a.cb(),t("getUserData",s.user.uid),t("downloadPersonalKey",s.user.uid)})).catch((e=>{console.log(e)}))},getUserData({commit:e,dispatch:t},a){Tt(`users/${a}`).then((s=>{const o=s.val();e("setName",o.name),e("setPhoto",o.photo),t("subscribeToUpdateDialogs",a),t("downloadUserPhoto",{photo:o.photo,uid:o.uid})})).catch((e=>{console.log(e)}))},downloadDialogs({dispatch:e},t){for(let a of t.dialogsID)Tt(`dialogs/${a}`).then((a=>{const s=a.val();e("downloadAddingDialogInfo",{dialog:s,uid:t.uid})})).catch((e=>{console.log(e)}))},downloadAddingDialogInfo({commit:e,dispatch:t},a){const s=a.dialog.uids.filter((e=>e!=a.uid));Tt(`users/${s}`).then((o=>{const n=o.val();let A;A=n.photo?`${n.uid}/${n.photo}`:"default/user.png",Lt(A).then((o=>{const A=new Image;A.src=o,A.onload=()=>{a.dialog.companionData={name:n.name,photo:A},e("addDialog",a.dialog),console.log("new dialog was downloaded"),t("subscribeToUpdateMessages",a.dialog.id),t("subscribeToUpdateAddingDialogInfo",{uid:s,dialogID:a.dialog.id})}})).catch((e=>{console.log(e)}))}))},subscribeToUpdateAddingDialogInfo({commit:e},t){$t(`users/${t.uid}/name`,(a=>{e("setCompanionName",{dialogID:t.dialogID,name:a.val()})})),$t(`users/${t.uid}/photo`,(a=>{a.val()&&Lt(`${t.uid}/${a.val()}`).then((a=>{const s=new Image;s.src=a,s.onload=()=>{e("setCompanionPhoto",{dialogID:t.dialogID,photo:s})}})).catch((e=>{console.log(e)}))}))},subscribeToUpdateDialogs({commit:e,dispatch:t},a){$t(`users/${a}/dialogs`,(s=>{e("clearDialogs"),console.log("new dialog!");const o=s.val().filter((e=>"dnone"!=e));e("setDialogsID",o),o.length&&t("downloadDialogs",{dialogsID:o,uid:a})}))},subscribeToUpdateMessages({commit:e,state:t},a){$t(`dialogs/${a}/messages`,(s=>{const o=s.val();a==t.currentDialog&&o[o.length-1].from!=t.uid&&(o[o.length-1].watched=!0),Wt(`dialogs/${a}/messages`,o),e("changeMessagesOfDialog",{mess:o,id:a})}))},openDialog({state:e,commit:t},a){if(e.dialogs.length){const s=e.dialogs.filter((e=>e.id==a))[0].messages;for(let t of s)t.from!=e.uid&&(t.watched=!0);Wt(`dialogs/${a}/messages`,s),t("setCurrentDialog",a)}},changeUserName({commit:e,state:t},a){Wt(`users/${t.uid}/name`,a).then((()=>{e("setName",a)})).catch((e=>{console.log(e)}))},downloadUserPhoto({commit:e},t){let a;a=t.photo?`${t.uid}/${t.photo}`:"default/user.png",Lt(a).then((t=>{const a=new Image;a.src=t,a.onload=()=>{e("setPhoto",a),e("setDownload",!1)}})).catch((e=>{console.log(e)}))},uploadUserPhoto({commit:e,state:t},a){e("setDownload",!0);const s=new FileReader;s.readAsDataURL(a),s.onload=s=>{const o=s.currentTarget.result;Ot(o,`${t.uid}/${a.name}`).then((()=>{Wt(`users/${t.uid}/photo`,a.name).then((()=>{const t=new Image;t.src=o,t.onload=()=>{e("setPhoto",t),e("setDownload",!1)}}))}))}},sendMessage({state:e},t){const a=e.dialogs.filter((e=>e.id==t.id))[0].messages;a.push({from:e.uid,text:t.text,watched:!1}),Wt(`dialogs/${t.id}/messages`,a)},downloadUsersList({commit:e}){e("clearUsersList"),Tt("users").then((t=>{const a=Object.values(t.val());for(let s of a){let t;t=s.photo?`${s.uid}/${s.photo}`:"default/user.png",Lt(t).then((t=>{const a=new Image;a.src=t,a.onload=()=>{s.photoObj=a,e("addUserInList",s)}}))}})).catch((e=>{console.log(e)}))}},mutations:{setCurrentDialog(e,t){e.currentDialog=t},setDownload(e,t){e.download=t},setUID(e,t){e.uid=t},setName(e,t){e.name=t},setDialogsID(e,t){e.dialogsID=t},setPhoto(e,t){e.photo=t},addDialog(e,t){e.dialogs.push(t)},changeMessagesOfDialog(e,t){e.dialogs.filter((e=>e.id==t.id))[0].messages=t.mess},addUserInList(e,t){e.users.push(t)},setCompanionName(e,t){e.dialogs.filter((e=>e.id==t.dialogID))[0].companionData.name=t.name},setCompanionPhoto(e,t){e.dialogs.filter((e=>e.id==t.dialogID))[0].companionData.photo=t.photo},clearUsersList(e){e.users=[]},clearDialogs(e){e.dialogs=[],e.dialogsID=[]},clearData(e){e.uid="",e.name="",e.photo="",e.dialogsID=[],e.dialogs=[],e.users=[]}},getters:{download(e){return e.download},uid(e){return e.uid},name(e){return e.name},dialogs(e){return e.dialogs},photo(e){return e.photo},users(e){const t=[e.uid],a=[];for(let s of e.dialogs)t.push(s.uids.filter((t=>t!=e.uid))[0]);for(let s of e.users)-1==t.indexOf(s.uid)&&a.push(s);return a}}});(0,s.ri)(l).use(Ht).use(Bt).mount("#app")}},t={};function a(s){var o=t[s];if(void 0!==o)return o.exports;var n=t[s]={exports:{}};return e[s].call(n.exports,n,n.exports,a),n.exports}a.m=e,function(){var e=[];a.O=function(t,s,o,n){if(!s){var A=1/0;for(d=0;d<e.length;d++){s=e[d][0],o=e[d][1],n=e[d][2];for(var i=!0,r=0;r<s.length;r++)(!1&n||A>=n)&&Object.keys(a.O).every((function(e){return a.O[e](s[r])}))?s.splice(r--,1):(i=!1,n<A&&(A=n));if(i){e.splice(d--,1);var l=o();void 0!==l&&(t=l)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[s,o,n]}}(),function(){a.d=function(e,t){for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={143:0};a.O.j=function(t){return 0===e[t]};var t=function(t,s){var o,n,A=s[0],i=s[1],r=s[2],l=0;if(A.some((function(t){return 0!==e[t]}))){for(o in i)a.o(i,o)&&(a.m[o]=i[o]);if(r)var d=r(a)}for(t&&t(s);l<A.length;l++)n=A[l],a.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return a.O(d)},s=self["webpackChunkintomyc"]=self["webpackChunkintomyc"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=a.O(void 0,[998],(function(){return a(7378)}));s=a.O(s)})();
//# sourceMappingURL=app.fc5ee0a7.js.map